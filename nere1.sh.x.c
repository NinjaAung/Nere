#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -H -f nere1.sh -o binary 
#endif

static  char data [] = 
#define      pswd_z	256
#define      pswd	((&data[15]))
	"\254\050\301\247\330\356\265\100\001\163\161\374\066\323\063\105"
	"\167\020\061\031\310\066\354\263\255\033\064\237\243\340\250\072"
	"\067\134\172\001\134\134\115\330\360\346\106\261\176\035\245\217"
	"\327\142\303\066\137\172\077\104\022\241\240\266\070\210\047\350"
	"\000\163\310\205\334\262\040\300\352\003\312\276\215\370\224\140"
	"\242\146\126\264\012\056\056\347\014\177\153\131\156\132\116\277"
	"\277\015\251\032\074\006\352\016\252\026\130\333\045\017\110\304"
	"\124\047\245\371\116\044\303\276\024\150\361\112\071\044\057\327"
	"\002\214\154\373\303\023\215\062\200\117\204\144\065\115\256\341"
	"\112\340\212\040\137\117\276\221\144\151\167\161\220\022\324\145"
	"\034\112\221\252\045\164\123\365\107\203\372\366\334\344\377\213"
	"\267\230\066\311\266\225\127\267\274\207\242\215\314\256\130\127"
	"\207\311\353\005\105\167\126\324\125\363\221\307\314\356\166\167"
	"\126\144\143\206\156\011\367\047\203\002\131\071\333\155\353\070"
	"\305\016\034\041\171\311\115\056\335\227\115\373\370\024\244\106"
	"\273\304\166\316\237\150\255\062\273\266\235\355\057\315\247\364"
	"\020\101\376\270\333\236\232\071\000\345\323\363\014\106\116\315"
	"\175\202\301\311\026\232\330\101\204\135\114\074\024\237\361\011"
	"\217\310\160\050"
#define      msg2_z	19
#define      msg2	((&data[292]))
	"\036\327\077\052\034\220\336\325\053\324\112\217\163\260\224\237"
	"\270\306\176"
#define      msg1_z	65
#define      msg1	((&data[325]))
	"\027\107\060\331\113\130\324\263\004\214\041\306\302\375\155\132"
	"\162\121\103\101\246\035\231\216\273\272\154\225\156\214\156\352"
	"\053\207\365\037\315\012\301\017\344\026\220\356\175\372\031\171"
	"\377\355\111\365\212\005\242\372\250\366\006\341\306\023\330\107"
	"\372\010\174\021\002\071\074\161\330\363\251\150\000\201\145\004"
	"\217\346\056\012\233"
#define      lsto_z	1
#define      lsto	((&data[396]))
	"\246"
#define      tst1_z	22
#define      tst1	((&data[399]))
	"\352\012\267\306\114\300\234\107\301\061\175\343\066\251\044\007"
	"\120\053\146\271\234\142\275\217\304"
#define      date_z	1
#define      date	((&data[422]))
	"\364"
#define      chk1_z	22
#define      chk1	((&data[424]))
	"\037\141\134\321\143\321\021\171\237\070\212\177\162\337\072\015"
	"\046\376\321\307\140\321\220\140\236\274"
#define      rlax_z	1
#define      rlax	((&data[449]))
	"\252"
#define      opts_z	1
#define      opts	((&data[450]))
	"\022"
#define      tst2_z	19
#define      tst2	((&data[454]))
	"\056\110\021\231\341\136\376\045\253\207\324\377\364\161\024\102"
	"\117\253\242\215\357\301\062\332"
#define      shll_z	10
#define      shll	((&data[475]))
	"\237\243\177\327\171\222\261\064\345\267\257"
#define      text_z	5064
#define      text	((&data[1099]))
	"\367\321\243\366\017\347\334\064\376\362\154\350\242\317\347\034"
	"\314\103\134\063\206\105\146\274\372\227\034\253\077\054\131\310"
	"\163\263\124\264\276\346\340\055\070\341\232\255\142\145\230\374"
	"\311\233\365\154\226\106\115\370\322\134\340\211\020\235\164\254"
	"\350\201\305\224\313\005\263\052\063\341\110\203\360\142\116\347"
	"\127\112\246\226\206\160\017\213\304\156\034\022\237\112\136\257"
	"\335\253\135\133\301\371\143\135\211\274\213\221\023\350\304\273"
	"\264\221\032\122\014\364\266\236\335\023\076\265\205\260\254\165"
	"\364\110\341\247\002\003\054\132\021\141\023\162\323\045\132\223"
	"\015\272\002\356\040\215\315\004\164\014\141\240\327\323\233\234"
	"\316\372\235\123\040\155\102\307\157\354\231\227\337\042\363\341"
	"\117\241\365\266\244\120\241\246\270\304\230\117\306\041\177\020"
	"\226\023\206\226\303\366\231\207\203\317\014\006\166\246\201\321"
	"\220\145\276\017\125\064\370\252\272\270\211\157\020\020\207\156"
	"\122\042\046\306\046\156\064\263\301\174\164\332\045\044\157\011"
	"\244\003\230\265\270\306\012\305\316\343\213\121\331\057\270\044"
	"\032\103\000\353\027\214\167\355\115\232\120\307\023\107\261\316"
	"\326\057\343\246\000\173\261\100\114\030\001\133\323\265\345\125"
	"\237\233\073\144\306\303\216\117\344\003\340\020\074\317\350\133"
	"\322\374\173\053\260\160\300\373\210\247\123\136\165\331\271\073"
	"\207\314\075\064\131\045\123\331\247\160\156\205\122\125\063\153"
	"\252\106\240\345\315\030\266\071\347\073\023\317\202\051\252\347"
	"\272\106\014\003\273\241\264\373\225\070\212\215\036\374\317\165"
	"\350\147\257\373\317\235\345\350\015\020\302\053\024\157\364\216"
	"\025\340\250\324\240\174\244\213\224\167\042\025\016\264\236\021"
	"\263\234\002\062\174\276\211\326\255\157\013\230\313\000\374\136"
	"\010\336\123\111\241\303\001\223\030\207\027\213\357\321\166\071"
	"\342\103\265\161\362\134\117\177\155\216\045\366\361\143\127\256"
	"\361\163\023\232\103\073\151\341\212\277\220\110\201\361\350\327"
	"\163\140\035\053\015\236\301\007\146\171\323\124\225\117\200\263"
	"\364\166\016\140\307\365\340\004\270\352\300\007\346\253\213\272"
	"\261\350\242\264\331\336\160\351\071\026\300\161\104\345\207\371"
	"\206\253\072\213\334\024\126\165\234\105\331\176\277\130\074\001"
	"\224\315\251\214\154\324\225\272\340\237\376\104\162\035\351\002"
	"\136\351\273\074\153\335\244\060\156\013\034\057\017\043\253\160"
	"\045\103\106\330\253\070\074\351\017\327\317\074\120\241\236\244"
	"\052\310\266\267\373\252\025\025\003\245\202\341\042\261\361\324"
	"\220\063\333\235\334\172\216\330\215\256\110\367\331\257\276\263"
	"\216\154\276\114\370\233\333\344\135\143\275\001\066\153\234\035"
	"\200\015\216\354\274\372\333\052\364\037\113\074\127\170\016\341"
	"\337\150\101\105\126\307\310\033\341\347\125\366\313\224\076\316"
	"\002\047\206\223\352\273\241\167\347\247\151\010\074\171\331\023"
	"\107\226\323\251\117\071\133\042\366\334\006\077\263\030\200\146"
	"\012\035\305\013\320\207\056\102\153\077\042\224\232\032\236\223"
	"\057\036\371\143\001\030\114\140\031\307\234\273\300\261\061\163"
	"\105\307\341\207\037\076\006\076\016\310\325\176\134\046\307\176"
	"\141\033\372\266\326\202\114\365\060\131\147\352\021\007\323\137"
	"\302\266\141\141\053\203\027\303\332\302\006\227\044\164\053\235"
	"\343\207\266\242\007\207\241\162\315\043\173\100\120\335\374\357"
	"\026\176\117\370\171\340\165\067\006\350\111\315\340\352\026\235"
	"\075\370\145\163\043\336\310\332\377\142\173\206\113\250\100\045"
	"\135\330\351\131\200\336\363\176\304\241\174\025\323\242\064\136"
	"\171\355\006\056\002\315\176\360\172\102\371\147\331\312\305\334"
	"\162\024\345\067\351\042\173\343\357\273\317\273\321\034\251\273"
	"\174\354\146\044\231\206\177\370\366\040\340\321\113\271\262\015"
	"\102\077\371\154\206\244\270\020\223\155\057\001\216\352\125\363"
	"\003\041\075\366\127\030\144\276\132\016\042\351\303\320\117\337"
	"\277\267\201\326\367\341\374\357\334\317\370\324\031\001\264\355"
	"\235\220\042\172\164\326\120\064\071\043\155\205\310\131\272\063"
	"\144\053\170\370\034\171\077\071\166\360\324\375\167\226\346\106"
	"\236\126\324\335\153\226\012\356\310\316\032\140\317\352\067\345"
	"\011\071\303\206\074\224\067\266\061\174\151\120\056\034\306\207"
	"\036\354\100\373\371\246\375\277\255\333\301\261\300\017\331\252"
	"\330\276\126\034\026\112\222\231\221\251\113\057\252\371\225\054"
	"\020\305\017\202\316\320\211\352\343\075\360\162\324\325\046\002"
	"\201\173\275\341\016\026\315\132\215\107\177\345\314\316\031\027"
	"\012\137\207\241\243\305\226\157\307\373\267\064\264\165\032\135"
	"\033\101\105\267\045\303\361\236\270\362\253\310\217\066\000\313"
	"\175\201\035\141\053\014\321\050\040\252\001\164\255\355\001\123"
	"\335\237\177\252\222\336\243\305\350\252\347\330\144\071\070\276"
	"\247\043\265\171\003\150\046\375\273\216\247\345\017\272\055\033"
	"\062\257\132\366\260\222\077\171\170\270\357\064\005\245\062\255"
	"\047\173\247\071\220\277\127\157\175\231\170\335\126\167\006\276"
	"\325\370\110\263\255\056\063\300\022\361\056\014\073\247\045\252"
	"\362\155\212\017\103\143\222\227\005\033\232\252\112\143\210\370"
	"\325\240\145\273\244\114\030\275\076\242\244\253\056\240\030\062"
	"\330\075\304\132\332\237\017\112\134\221\071\167\373\177\052\356"
	"\327\277\355\053\351\040\355\035\042\322\075\151\335\133\333\012"
	"\273\032\046\071\023\377\146\357\013\162\044\172\314\164\230\024"
	"\074\157\103\314\006\261\365\312\276\167\173\355\225\264\261\075"
	"\042\125\355\344\043\013\002\252\210\105\127\245\332\315\153\105"
	"\113\047\251\201\315\103\231\304\317\211\051\277\342\105\336\043"
	"\305\061\020\040\235\356\305\206\303\270\314\254\016\053\047\070"
	"\203\073\216\324\066\154\006\233\016\302\326\350\070\153\026\030"
	"\154\052\344\137\010\237\377\341\203\075\367\251\342\206\376\305"
	"\074\261\270\136\123\145\137\174\377\175\300\342\215\304\241\204"
	"\317\047\160\117\237\152\244\104\341\342\254\267\154\246\070\327"
	"\264\060\241\170\304\272\030\322\025\076\206\372\330\033\350\012"
	"\373\110\361\356\243\204\044\240\144\217\127\271\257\051\363\367"
	"\172\305\325\225\323\155\321\340\212\205\257\322\021\323\055\157"
	"\235\313\043\305\266\225\276\354\074\045\154\327\013\121\151\203"
	"\344\056\237\126\032\334\325\104\012\334\034\252\155\050\275\223"
	"\176\355\100\122\211\301\207\117\266\374\176\265\010\072\062\004"
	"\147\167\314\050\143\201\166\027\070\317\171\075\302\355\170\050"
	"\157\374\134\144\130\204\364\247\160\036\072\154\063\234\224\004"
	"\174\065\024\241\224\261\054\273\133\003\105\155\364\324\257\173"
	"\200\161\054\153\170\210\061\323\001\061\346\106\107\131\126\212"
	"\206\261\077\102\065\212\150\175\017\040\031\374\130\057\323\110"
	"\132\050\036\302\162\222\111\061\352\235\244\343\130\326\122\335"
	"\171\014\200\100\023\312\265\347\151\144\253\100\134\224\170\223"
	"\007\146\250\170\264\245\254\003\331\121\136\326\074\321\037\316"
	"\375\033\016\221\133\362\001\317\352\127\020\210\125\215\345\156"
	"\173\002\316\155\036\013\131\331\004\112\211\100\300\352\204\160"
	"\364\314\107\326\372\134\073\272\050\015\152\255\226\023\326\006"
	"\324\144\003\134\324\164\051\270\365\267\103\066\301\162\023\212"
	"\236\061\051\040\266\251\302\252\020\336\104\071\145\015\221\177"
	"\063\004\143\323\364\000\107\106\112\253\005\224\250\172\105\343"
	"\334\102\351\375\125\114\231\061\273\007\023\143\060\126\174\343"
	"\277\276\157\325\130\063\134\016\122\067\053\014\055\367\216\237"
	"\252\025\012\344\242\320\371\360\343\024\366\201\151\277\334\025"
	"\342\274\210\175\230\227\370\022\102\074\300\317\250\271\025\107"
	"\245\330\026\357\026\143\035\277\146\246\077\356\132\047\163\010"
	"\033\077\113\307\225\343\202\251\130\206\004\110\125\123\161\360"
	"\370\347\043\327\355\341\330\366\013\045\157\111\343\317\200\342"
	"\215\130\344\214\176\307\270\256\075\165\344\070\227\014\100\335"
	"\026\336\061\306\130\157\307\220\152\011\065\263\160\130\160\012"
	"\060\346\206\161\330\014\127\070\066\302\236\206\130\061\232\134"
	"\266\334\100\132\230\101\375\312\155\104\101\244\167\260\244\073"
	"\375\045\363\042\064\107\012\022\341\225\317\053\061\310\360\302"
	"\067\063\045\330\033\000\075\254\064\135\305\161\324\200\357\343"
	"\364\372\223\021\006\332\127\006\005\042\052\025\133\115\172\031"
	"\010\067\024\375\375\371\334\341\333\252\301\334\132\251\037\133"
	"\046\261\145\360\025\272\153\363\006\313\156\046\102\120\342\277"
	"\222\266\256\325\333\127\034\353\114\002\227\220\026\354\137\201"
	"\105\313\255\027\120\337\222\014\357\252\160\371\230\101\064\164"
	"\014\031\110\000\004\067\047\227\225\152\344\151\056\103\271\356"
	"\125\236\053\107\256\074\342\162\201\135\336\050\016\121\315\052"
	"\061\147\226\173\205\006\217\241\303\105\060\207\215\354\010\361"
	"\304\272\105\106\051\167\266\210\337\371\017\310\354\144\216\214"
	"\211\140\277\073\375\006\200\361\265\176\163\227\037\172\107\005"
	"\036\064\055\053\360\112\174\320\065\006\251\121\211\034\025\032"
	"\320\275\020\274\271\174\270\147\165\163\304\270\357\374\160\112"
	"\234\170\067\172\245\137\146\224\132\135\063\307\133\003\154\000"
	"\124\231\127\331\330\154\074\367\322\254\370\260\252\164\150\317"
	"\203\110\307\304\274\305\132\266\056\277\151\071\054\220\374\032"
	"\240\346\012\071\164\301\375\022\271\001\170\227\135\230\055\301"
	"\152\321\142\160\162\176\365\127\141\040\225\035\031\336\206\104"
	"\267\220\370\306\105\053\006\313\044\002\065\352\371\135\355\051"
	"\016\031\163\264\200\234\115\147\163\061\152\071\106\106\306\226"
	"\217\274\142\301\001\327\051\026\314\307\265\140\331\007\344\015"
	"\276\366\106\034\151\201\100\127\325\025\312\040\345\152\357\333"
	"\166\072\171\124\077\130\243\012\077\251\353\036\033\262\344\041"
	"\323\151\234\213\057\100\140\332\310\034\017\135\353\313\070\273"
	"\066\147\240\234\073\054\271\241\272\034\124\064\262\135\354\157"
	"\310\047\232\263\105\261\314\276\113\340\247\145\216\272\052\266"
	"\223\123\041\174\204\200\206\204\224\303\035\331\314\125\334\227"
	"\253\037\351\324\111\263\213\003\065\175\325\110\315\220\267\207"
	"\300\331\041\151\062\041\055\125\130\356\002\011\145\230\000\345"
	"\052\360\260\127\315\341\165\367\140\312\144\271\133\206\127\254"
	"\311\041\247\065\115\123\275\250\040\074\024\302\213\056\177\340"
	"\233\310\242\206\230\015\221\165\131\166\142\300\353\306\336\220"
	"\265\247\355\335\116\160\231\302\342\177\376\366\032\200\170\320"
	"\225\034\207\164\062\377\361\067\270\241\116\377\125\307\072\012"
	"\042\225\253\237\017\375\047\024\167\227\214\325\065\315\344\236"
	"\132\273\364\312\241\140\163\215\074\102\330\076\372\160\067\156"
	"\044\333\143\255\054\072\236\175\011\073\213\150\334\100\062\334"
	"\016\057\271\021\156\103\064\212\245\010\272\330\360\346\062\003"
	"\276\304\323\031\340\237\063\323\056\001\103\330\364\033\251\355"
	"\367\352\102\114\204\211\004\336\171\116\346\246\067\322\045\034"
	"\360\100\166\356\115\131\060\372\032\165\111\355\360\064\037\124"
	"\007\125\306\150\214\030\172\277\212\132\036\272\053\047\030\332"
	"\174\367\040\205\315\031\015\340\321\304\176\120\205\014\045\266"
	"\206\106\370\201\031\326\106\126\153\350\022\242\047\074\006\004"
	"\235\130\032\302\060\135\233\350\056\373\234\216\055\250\106\040"
	"\166\252\123\122\370\360\000\067\304\333\222\262\026\302\127\251"
	"\335\200\343\355\210\255\206\341\223\373\275\253\044\376\377\117"
	"\223\365\025\245\030\160\255\360\207\264\077\301\021\070\174\054"
	"\071\045\305\263\254\164\357\323\032\057\024\165\272\056\156\321"
	"\244\231\061\167\243\010\204\375\223\154\042\141\160\000\130\151"
	"\154\170\151\172\224\317\121\114\214\220\257\050\134\073\245\201"
	"\375\043\261\261\126\235\015\206\363\077\347\314\203\202\332\251"
	"\065\021\271\264\035\066\021\273\266\316\340\002\344\167\272\310"
	"\341\112\311\244\273\112\231\177\255\305\020\257\267\017\147\126"
	"\364\064\257\367\212\101\146\160\145\344\302\101\124\270\034\146"
	"\203\371\353\011\311\075\350\350\302\362\140\313\325\045\254\161"
	"\004\002\040\141\164\252\363\262\344\220\307\342\036\025\007\146"
	"\025\046\222\167\001\017\003\163\014\337\025\117\034\210\276\364"
	"\315\175\235\175\067\311\114\156\320\372\235\076\233\275\354\204"
	"\224\246\154\172\115\127\250\025\106\006\132\200\337\147\343\341"
	"\221\361\350\303\224\126\332\063\237\066\354\071\216\124\351\222"
	"\077\317\000\241\224\337\351\271\333\322\010\374\373\224\335\371"
	"\163\065\305\310\372\330\072\073\055\205\230\032\112\240\324\304"
	"\262\134\326\374\214\107\325\003\342\216\031\217\170\076\176\331"
	"\074\304\151\102\242\012\176\125\122\072\057\063\155\160\210\345"
	"\067\266\010\022\204\224\073\244\366\134\241\121\245\245\053\070"
	"\247\162\361\044\333\116\040\341\172\236\075\076\254\126\303\152"
	"\136\271\053\321\174\333\004\030\057\031\365\021\034\013\333\057"
	"\267\214\316\156\001\070\263\254\237\347\177\200\100\007\117\004"
	"\032\113\370\241\105\055\117\222\153\032\027\022\141\154\356\240"
	"\125\350\231\274\217\374\065\044\206\241\141\377\071\274\366\120"
	"\233\256\067\326\064\233\256\000\162\015\202\152\112\042\017\002"
	"\113\333\002\041\121\012\341\145\302\214\202\163\076\120\261\274"
	"\046\230\050\057\315\147\104\312\221\056\027\345\002\116\233\346"
	"\237\037\323\000\225\172\174\006\262\310\360\344\076\203\246\365"
	"\136\072\061\271\022\142\073\351\311\270\102\151\222\162\053\136"
	"\360\263\120\213\023\005\057\126\020\051\067\054\012\012\315\256"
	"\033\165\312\144\022\327\226\267\063\201\313\057\117\232\276\152"
	"\015\052\342\101\113\273\311\221\160\245\261\277\243\274\320\050"
	"\277\230\350\367\044\264\010\065\137\123\214\124\145\352\274\103"
	"\277\271\024\161\300\316\076\172\163\002\251\360\322\325\360\116"
	"\253\327\176\157\302\032\323\133\077\151\336\067\040\244\270\041"
	"\176\355\245\000\003\372\210\374\352\250\353\343\331\335\112\013"
	"\343\047\020\013\147\356\043\334\061\232\002\224\044\060\025\353"
	"\340\207\170\240\007\210\045\375\241\046\170\164\013\326\242\147"
	"\135\232\025\016\324\136\330\071\311\062\331\010\017\145\345\237"
	"\326\106\123\100\224\307\175\136\263\304\243\012\003\175\321\124"
	"\147\307\071\266\160\041\040\376\365\305\154\160\055\272\100\213"
	"\270\243\241\315\032\350\040\121\150\127\233\132\001\045\072\001"
	"\307\244\251\235\222\031\373\335\041\264\306\122\006\252\231\267"
	"\024\040\063\112\343\037\220\032\051\171\160\121\221\330\171\057"
	"\203\202\226\035\106\330\136\205\061\167\116\116\310\271\317\026"
	"\062\166\000\205\171\337\154\243\131\056\053\235\265\374\040\036"
	"\367\171\065\226\200\215\102\101\010\022\056\302\072\325\112\153"
	"\032\132\327\337\130\110\333\342\357\173\200\223\276\014\102\214"
	"\037\247\021\256\176\177\140\110\161\042\025\310\253\234\064\246"
	"\032\324\375\242\037\357\213\213\223\372\030\040\015\061\253\275"
	"\104\114\125\057\102\300\340\050\132\302\073\337\036\045\034\163"
	"\323\337\040\111\161\274\355\204\226\322\377\215\156\261\300\301"
	"\346\330\340\323\160\002\112\241\221\144\346\101\210\363\336\255"
	"\333\141\251\165\031\275\072\023\037\167\111\035\000\046\034\172"
	"\143\153\241\356\251\002\314\013\330\114\306\166\357\266\306\240"
	"\345\031\075\363\350\304\374\022\364\103\247\344\021\204\216\142"
	"\300\310\141\212\313\272\211\011\262\155\347\355\243\154\263\335"
	"\040\334\100\131\341\004\213\155\114\306\142\030\312\201\044\327"
	"\316\246\340\237\224\032\141\266\372\362\231\333\102\377\241\252"
	"\267\342\346\020\165\220\011\056\333\120\274\007\023\041\273\031"
	"\046\351\371\106\163\153\347\361\135\356\327\266\120\035\216\142"
	"\013\024\250\225\254\202\364\344\331\137\232\123\004\022\260\301"
	"\162\146\272\370\016\224\357\144\016\243\362\153\326\211\044\117"
	"\223\252\033\233\117\176\167\206\032\172\256\146\375\065\217\177"
	"\117\124\161\111\175\032\000\310\376\131\164\152\272\262\326\006"
	"\343\173\132\154\005\342\143\062\066\062\265\065\346\325\142\354"
	"\345\353\072\122\175\172\261\132\372\173\017\236\001\014\315\070"
	"\305\035\072\055\104\037\364\333\210\272\302\226\076\076\110\176"
	"\302\334\230\205\137\322\224\212\344\077\053\174\102\144\055\050"
	"\056\236\033\120\044\326\023\064\204\341\233\057\231\360\340\141"
	"\315\162\025\072\221\143\065\241\242\305\212\004\327\060\216\155"
	"\173\011\035\306\076\020\326\374\210\102\002\141\036\250\211\111"
	"\070\324\227\265\041\226\232\030\363\233\172\074\100\132\275\271"
	"\140\165\100\032\325\211\201\340\051\061\056\113\070\303\371\376"
	"\305\337\326\153\032\320\110\007\347\203\233\070\302\111\133\273"
	"\366\130\073\225\373\236\051\226\300\207\352\012\317\143\236\207"
	"\322\053\350\112\151\306\343\355\112\162\267\367\377\241\376\007"
	"\065\067\343\373\011\100\272\244\213\027\202\101\122\171\104\237"
	"\066\143\352\000\122\071\145\071\137\070\122\362\315\027\061\304"
	"\133\200\140\254\072\124\376\156\052\357\045\350\214\041\366\023"
	"\020\151\136\007\064\012\213\244\005\155\331\160\242\116\103\315"
	"\275\205\357\121\304\002\017\214\006\066\013\322\052\254\107\034"
	"\300\056\277\333\173\320\021\126\060\341\025\360\273\115\373\144"
	"\311\230\230\227\254\311\023\107\162\307\023\203\322\271\315\301"
	"\007\104\015\251\130\140\077\147\260\257\227\171\017\025\362\173"
	"\102\236\045\354\336\211\306\323\034\256\030\045\071\365\166\255"
	"\031\250\125\113\162\346\216\310\217\357\211\072\252\004\122\066"
	"\270\210\265\274\136\234\050\122\030\234\012\061\340\152\172\260"
	"\044\253\347\167\320\216\146\071\046\162\075\317\004\031\122\342"
	"\110\074\316\252\372\255\016\050\243\236\366\012\051\114\377\131"
	"\300\156\261\360\246\261\071\001\251\271\042\123\321\160\307\204"
	"\255\175\243\155\057\030\362\317\356\060\021\327\344\215\261\052"
	"\237\152\222\305\230\370\264\102\252\122\306\366\335\055\212\317"
	"\135\236\160\341\337\260\134\264\017\253\327\323\367\115\327\247"
	"\044\104\352\012\220\141\134\265\021\016\320\013\232\104\153\275"
	"\227\172\242\026\142\216\321\162\041\027\011\131\003\220\123\054"
	"\036\136\325\371\024\346\031\245\013\220\017\046\152\103\210\161"
	"\273\042\165\153\007\162\234\144\125\030\004\156\141\216\137\123"
	"\203\362\050\245\342\023\132\174\342\355\014\267\175\006\352\105"
	"\046\265\045\075\164\013\226\124\101\173\206\224\036\113\135\066"
	"\106\010\140\152\262\334\225\062\127\057\164\275\101\257\161\376"
	"\036\366\070\260\326\374\042\307\000\331\042\364\024\165\153\311"
	"\041\227\103\356\340\042\322\234\345\316\112\176\326\003\262\150"
	"\105\163\124\204\203\021\235\236\172\013\123\141\306\244\115\252"
	"\323\220\341\104\370\351\320\052\322\255\202\054\201\001\107\273"
	"\262\001\305\261\127\001\344\334\112\235\021\240\257\147\011\371"
	"\142\370\233\202\325\170\011\226\224\025\042\032\067\370\070\107"
	"\140\146\123\346\374\213\033\040\266\311\113\013\207\176\332\167"
	"\164\241\374\153\212\074\162\331\165\266\332\131\171\204\057\110"
	"\167\102\310\270\327\067\366\013\211\005\012\174\164\120\256\100"
	"\276\212\050\055\242\310\115\256\065\244\003\213\033\145\302\230"
	"\064\130\332\100\213\114\062\300\053\010\347\266\167\330\030\043"
	"\013\202\307\077\053\026\117\126\143\315\133\133\253\261\317\230"
	"\313\322\125\216\110\062\224\176\064\346\046\245\212\153\177\171"
	"\252\023\103\105\306\160\274\307\173\304\041\156\116\312\157\022"
	"\205\362\134\272\354\264\165\256\150\346\134\154\314\101\061\357"
	"\034\034\371\326\357\127\020\143\063\055\144\306\343\075\004\117"
	"\213\371\332\002\014\016\045\265\101\374\154\134\345\332\215\206"
	"\317\365\165\271\345\254\347\346\324\120\213\100\107\170\360\177"
	"\322\161\070\361\201\212\037\302\074\156\151\245\121\061\131\274"
	"\102\012\265\305\110\024\360\301\201\320\155\123\303\005\017\341"
	"\240\211\154\020\233\061\053\261\212\024\204\310\023\051\222\176"
	"\132\070\015\335\012\267\033\370\026\057\323\367\370\333\074\164"
	"\267\030\250\135\273\331\044\031\306\104\306\205\366\301\012\306"
	"\043\002\223\340\322\163\112\250\215\142\104\345\277\156\365\352"
	"\002\001\261\164\340\361\240\356\202\073\267\102\165\305\033\261"
	"\113\332\131\177\324\333\271\354\143\330\133\322\247\266\376\377"
	"\142\374\274\042\071\275\146\243\227\376\035\007\002\347\176\155"
	"\111\326\010\041\036\274\027\363\001\250\172\024\255\356\042\122"
	"\217\220\122\132\122\012\116\051\011\361\234\102\000\202\040\057"
	"\201\353\336\350\106\352\057\025\105\271\202\063\270\025\025\322"
	"\017\046\353\216\250\002\126\041\243\024\172\036\130\210\251\021"
	"\353\271\173\032\350\172\071\073\247\132\075\135\106\023\213\124"
	"\077\002\016\113\252\372\346\160\346\032\141\072\131\071\327\370"
	"\270\134\332\113\014\025\056\102\157\035\006\020\036\042\227\154"
	"\177\066\147\136\121\072\024\352\141\313\131\331\322\300\275\222"
	"\340\072\116\252\312\110\060\367\212\277\160\321\044\326\031\022"
	"\304\226\336\141\227\047\217\342\004\303\126\166\027\007\366\353"
	"\131\077\156\203\231\255\061\035\223\103\150\361\107\307\161\070"
	"\320\170\130\210\220\120\015\170\125\113\065\216\235\364\373\237"
	"\312\035\145\035\103\133\177\122\075\003\331\036\274\232\324\233"
	"\005\160\135\152\004\221\075\371\102\350\140\316\016\140\066\357"
	"\332\123\121\301\303\316\102\302\360\060\153\123\060\360\033\234"
	"\123\270\306\170\371\122\317\074\064\335\042\257\253\331\003\147"
	"\071\373\134\253\040\300\216\231\177\157\207\077\046\342\363\117"
	"\121\116\027\124\074\363\050\222\037\340\145\024\227\012\252\055"
	"\236\267\023\015\143\234\210\037\372\021\254\151\362\266\050\255"
	"\144\154\064\336\201\067\030\330\237\146\341\243\152\067\232\120"
	"\151\053\174\071\057\026\374\140\137\210\257\244\216\164\335\035"
	"\224\271\064\117\003\042\007\100\027\003\200\074\301\254\335\267"
	"\130\304\046\250\130\301\245\317\122\321\112\223\213\162\002\214"
	"\276\155\202\120\120\144\356\301\151\103\317\202\304\261\011\003"
	"\066\122\164\116\111\176\221\057\247\145\132\323\316\167\135\265"
	"\334\323\033\313\354\346\154\324\067\014\070\315\224\044\162\031"
	"\207\245\250\140\035\303\362\216\311\035\327\313\175\346\027\206"
	"\052\253\116\063\006\121\224\015\332\174\020\362\220\130\032\022"
	"\045\141\256\325\241\326\351\104\107\151\146\336\263\250\207\237"
	"\212\011\044\107\315\374\263\206\314\130\037\311\341\237\210\164"
	"\273\110\316\315\333\275\055\215\247\365\100\317\214\212\023\310"
	"\261\173\246\041\143\042\247\135\217\056\266\111\320\314\103\266"
	"\210\012\127\146\253\007\266\075\055\303\067\107\365\177\360\175"
	"\310\177\203\217\112\020\061\355\034\037\276\275\224\013\033\214"
	"\174\225\361\120\205\142\162\161\111\376\171\275\246\211\350\054"
	"\315\171\321\373\035\252\162\323\304\047\272\125\331\142\256\201"
	"\173\063\241\330\335\145\246\065\300\326\146\105\300\004\126\167"
	"\326\271\013\203\273\250\157\071\205\272\316\002\144\350\067\242"
	"\050\357\323\143\322\336\157\020\110\200\365\176\330\371\341\166"
	"\312\361\214\377\165\157\224\321\245\001\324\101\014\155\234\302"
	"\300\230\271\157\030\214\307\057\061\247\227\340\057\002\246\314"
	"\341\351\360\272\363\330\334\313\355\321\263\043\336\107\053\152"
	"\135\172\247\343\154\120\111\263\023\115\051\241\200\213\203\321"
	"\173\142\134\351\104\315\244\006\313\170\007\036\157\222\271\303"
	"\313\217\140\133\066\373\126\057\366\242\120\132\123\202\226\005"
	"\265\326\230\163\260\140\327\107\261\063\265\176\317\107\156\054"
	"\116\001\162\305\156\060\252\170\052\245\166\057\317\375\272\022"
	"\377\216\364\042\204\214\036\312\317\060\366\153\210\025\216\303"
	"\007\333\306\106\123\077\237\061\026\042\163\252\043\254\013\047"
	"\311\215\374\140\311\205\107\164\326\035\320\120\317\052\133\040"
	"\151\066\254\151\370\134\243\370\345\273\041\337\171\243\316\374"
	"\146\304\265\115\333\256\022\237\300\104\004\326\350\126\216\031"
	"\367\046\307\301\155\343\366\052\026\152\130\163\060\142\351\122"
	"\104\346\127\060\172\325\375\262\311\045\172\056\053\315\200\143"
	"\371\145\203\142\124\060\357\007\141\276\116\162\053\260\003\137"
	"\216\161\113\200\333\332\171\274\013\211\146\231\217\371\036\026"
	"\262\260\130\145\236\003\015\176\164\107\341\276\206\364\257\102"
	"\224\300\142\174\047\245\140\141\006\055\066\266\372\175\365\133"
	"\141\047\041\170\353\215\167\126\103\014\017\104\216\320\070\202"
	"\005\332\065\232\017\157\175\243\171\032\033\257\357\347\345\134"
	"\002\160\014\321\362\030\254\344\367\175\260\254\206\370\377\151"
	"\304\056\206\337\335\034\200\202\123\126\325\027\126\333\250\234"
	"\073\205\335\155\007\252\005\201\327\345\206\147\166\141\205\041"
	"\035\107\335\230\227\314\304\102\267\353\033\112\350\121\050\334"
	"\327\124\334\322\165\122\377\067\244\340\106\175\164\064\212\330"
	"\307\277\057\316\150\105\253\177\032\235\065\207\375\324\100\220"
	"\220\164\256\034\364\367\276\016\340\166\177\036\227\113\123\024"
	"\265\341\060\374\017\045\273\111\124\352\225\176\172\214\324\102"
	"\166\157\204\046\146\127\227\205\362\052\222\026\310\146\247\104"
	"\346\022\175\322\321\226\342\345\362\270\247\144\252\343\337\331"
	"\167\174\132\364\032\163\056\045\241\051\104\372\236\142\231\205"
	"\065\102\270\031\353\044\346\353\347\011\043\165\157\202\002\274"
	"\226\336\344\232\247\151\065\026\042\063\207\313\355\070\052\162"
	"\142\110\010\233\134\006\150\235\340\342\131\334\362\345\333\225"
	"\311\172\135\250\001\132\042\071\253\246\201\342\261\252\254\226"
	"\243\051\367\275\165\272\001\355\331\226\321\010\225\065\146\041"
	"\111\126\031\224\340\116\026\110\153\305\350\000\331\363\205\206"
	"\012\041\341\072\305\043\073\337\267\172\276\306\321\164\143\357"
	"\063\121\262\107\253\021\253\115\224\335\273\141\134\222\217\004"
	"\162\171\115\100\232\176\172\370\115\301\262\225\236\323\116\241"
	"\362\203\047\351\136\231\045\252\070\117\303\375\063\053\006\206"
	"\046\130\174\077\073\124\073\300\100\076\061\233\322\146\166\240"
	"\157\241\175\056\105\005\333\133\264\131\333\030\044\170\127\014"
	"\117\145\040\073\016\313\256\316\137\004\254\264\260\021\026\113"
	"\221\062\044\263\105\011\051\257\233\177\132\076\113\027\255\375"
	"\215\005\136\352\361\165\277\227\150\160\337\350\070\343\022\212"
	"\266\354\006\023\317\321\032\153\123\135\155\340\027\226\111\047"
	"\317\130\321\303\024\356\064\215\257\364\261\313\034\013\317\266"
	"\112\055\001\137\114\103\326\326\243\244\150\272\112\120\046\327"
	"\034\011\326\204\134\030\112\267\340\052\247\365\346\324\002\040"
	"\065\021\177\254\036\231\003\151\000\373\172\160\277\316\006\052"
	"\122\070\322\334\117\137\344\247\234\255\076\106\172\064\246\016"
	"\322\063\256\063\017\140\331\274\241\161\370\037\010\302\171\165"
	"\202\063\203\135\301\247\204\062\271\015\170\120\353\036\330\344"
	"\102\306\066\000\237\342\123\116\027\135\041\176\154\024\156\263"
	"\217\111\365\017\232\262\305\201\117\016\007\170\302\123\373\330"
	"\301\134\227\232\222\132\062\042\135\224\165\233\332\361\071\166"
	"\153\331\147\172\043\363\276\264\377\056\303\066\343\144\217\207"
	"\316\363\224\073\102\025\325\241\345\154\254\242\254\105\030\236"
	"\265\367\361\031\270\376\045\341\066\332\305\216\274\340\262\136"
	"\256\377\120\025\317\216\044\162\253\371\372\145\213\033\240\356"
	"\377\210\323\374\156\323\065\343\124\364\365\220\324\070\125\353"
	"\055\221\247\101\133\224\153\376\350\114\031\306\257\066\325\116"
	"\141\167\163\002\144\357\170\271\303\312\336\015\023\336\353\062"
	"\327\350\335\174\353\337\366\017\001\341\205\336\054\042\136\166"
	"\051\272\223\202\013\110\051\152\105\036\166\101\153\204\176\122"
	"\170\374\030\075\261\115\076\163\167\352\050\201\127\073\205\114"
	"\320\055\110\221\345\260\137\201\162\322\005\275\331\007\236\256"
	"\027\052\171\263\237\131\302\261\040\212\332\343\164\247\211\232"
	"\324\131\152\036\120\077\073\112\010\235\357\106\011\312\271\362"
	"\336\366\210\274\004\142\157\153\130\244\174\125\035\377\317\251"
	"\267\362\335\045\326\326\006\136\377\033\240\040\111\061\144\323"
	"\030\300\255\245\327\303\367\022\033\345\011\370\162\321\033\037"
	"\245\013\051\027\337\316\143\261\254\262\265\110\274\315\022\130"
	"\066\321\046\121\116\120\036\232\176\220\116\121\115\363\225\103"
	"\237\102\147\350\052\307\260\031\233\231\146\141\217\251\127\144"
	"\326\263\041\363\256\111\245\313\366\337\362\201\164\144\237\064"
	"\335\076\067\145\307\056\046\175\376\331\325\152\105\173\216\233"
	"\215\324\112\166\274\156\014\325\117\262\010\227\331\060\211\073"
	"\213\056\015\374\124\154\350\254\206\266\314\166\357\050\251\147"
	"\325\252\336\171\222\230\104\357\060\222\044\174\217\311\223\302"
	"\305\213\254\135\154\134\136\361\165\265\212\272\323\245\312\115"
	"\261\062\132\060\321\372\025\355\220\062\177\325\151\132\001\150"
	"\166\114\144\155\044\160\230\317\171\060\164\002\013\241\030\047"
	"\340\125\117\340\244\047\342\275\040\355\376\117\037\130\155\072"
	"\066\350\227\254\127\206\035\213\355\137\002\366\012\107\353\025"
	"\075\070\305\000\003\206\027\255\105\060\153\336\322\077\051\144"
	"\064\100\341\107\301\036\340\232\052\146\335\307\322\367\157\016"
	"\225\026\147\225\217\055\116\126\021\176\335\056\137\135\261\262"
	"\017\045\071\116\063\046\042\342\352\265\365\155\254\344\244\214"
	"\226\316\270\332\307\272\121\071\004\076\352\311\137\114\054\322"
	"\265\152\254\222\365\046\363\146\211\246\152\040\367"
#define      inlo_z	3
#define      inlo	((&data[7299]))
	"\241\003\333"
#define      chk2_z	19
#define      chk2	((&data[7306]))
	"\306\006\073\273\304\233\252\007\275\045\333\325\034\367\033\017"
	"\341\251\356\175\106\275\345"
#define      xecc_z	15
#define      xecc	((&data[7327]))
	"\330\120\101\174\070\211\156\172\261\332\347\256\151\125\204\255"
	"\151\037"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	1	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
